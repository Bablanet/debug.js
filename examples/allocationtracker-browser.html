<!doctype html>
<script src='../src/parsestacktrace.js'></script>
<script src='../src/allocationtracker.js'></script>
<script>

function aClass(){
	allocationTracker.record('aClass')
};

function aClass2(){
	allocationTracker.record('aClass2')
};


new aClass(); new aClass();
new aClass();
setInterval(function(){
	new aClass(); new aClass(); new aClass(); new aClass();
	new aClass2();
	new aClass2();	
}, 100)


// console.dir(allocationTracker._klasses);
//console.log(allocationTracker.reportString());



// allocationtracker-monitor.js in examples/js
// - include a button in the dom
// - on click

// open a window and report current allocation
var myPopup = window.open('allocationtracker-browser-frame.html','newtab');
setInterval(function(){
	var reportString	= allocationTracker.reportString();

	myPopup.postMessage(reportString,'*'); //send the message and target URI

	// reset counters every time
	allocationTracker.reset();
}, 1000);

</script>